kango.XHRRequest=function(){this.method="GET";this.url="";this.params={};this.headers={};this.async=!0;this.mimeType=this.password=this.username=this.contentType=""};kango.XHRResult=function(){this.response="";this.status=0};kango.XHR=function(){};
kango.XHR.prototype={_paramsToString:function(c){var b="",a;for(a in c)c.hasOwnProperty(a)&&(""!=b&&(b+="&"),b+=a+"="+c[a]);return b},getXMLHttpRequest:function(){return new XMLHttpRequest},send:function(c,b){var a=this.getXMLHttpRequest(),k=c.method||"GET",p="undefined"!=typeof c.async?c.async:!0,d=c.params||null,g=c.contentType||"text",e=c.url,q=c.username||null,r=c.password||null,f=c.headers||{},m=c.mimeType||null;kango.io.isLocalUrl(e)&&(e=kango.io.getExtensionFileUrl(e));var n=function(a,c){var b=
{response:null,status:0,abort:function(){a.abort()}};if(2<=a.readyState&&(b.status=a.status,4==a.readyState)){if("xml"==c)b.response=a.responseXML;else if("json"==c)try{b.response=JSON.parse(a.responseText)}catch(d){}else b.response=a.responseText;b.abort=function(){}}return b},h=function(){return{response:null,status:0,abort:function(){}}};null!=d&&("object"==typeof c.params&&(d=this._paramsToString(d),"POST"==k&&(f["Content-Type"]="application/x-www-form-urlencoded")),"GET"==k&&(e=e+"?"+d,d=null));
try{a.open(k,e,p,q,r)}catch(s){return kango.func.isCallable(b)&&b(h()),h()}"undefined"!=typeof a.overrideMimeType&&(null!=m?a.overrideMimeType(m):"json"==g?a.overrideMimeType("application/json"):"text"==g&&a.overrideMimeType("text/plain"));a.onreadystatechange=function(){4==a.readyState&&kango.func.isCallable(b)&&b(n(a,g))};if("object"==typeof f)for(var l in f)f.hasOwnProperty(l)&&a.setRequestHeader(l,f[l]);try{a.send(d)}catch(t){return kango.func.isCallable(b)&&b(h()),h()}return n(a,g)}};
kango.registerModule(kango.getDefaultModuleRegistrar("xhr",kango.XHR));
